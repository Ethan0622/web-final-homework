<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>狐说科普网</title>
    <script src="lib/jquery.min.js"></script>
    <script src="lib/vue.js"></script>
    <link rel="stylesheet" href="src/css/default.css">
    <!-- <link rel="stylesheet" href="lib/bootstrap.css"> -->

    <style>
        .container {
            width: 400px;
            height: 300px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: antiquewhite;
            z-index: 20;
        }

        #sign-area,
        #login-area {
            display: none;
        }
    </style>
</head>

<body>
    <nav class="nav">
        <div class="logo-area"></div>
        <div class="items-area">
            <div><a id="active-item">首页</a></div>
            <div><a>关于网站</a></div>
            <div><a>关于我们</a></div>
            <div><a>资源下载</a></div>
        </div>
        <div class="login-area">
            <button id="show-login">登录</button>
        </div>
    </nav>

    <div class="container" id="login-area">
        <label>
            用户名：
            <input type="text" class="form-control" name="username" id="login-name" />
        </label>
        <label>
            密码：
            <input type="password" class="form-control" name="pwd" id="login-pwd" />
        </label>
        </br>
        <input type="button" value="登录" class="btn btn-primary" id="login" />
    </div>

    <div class="container" id="sign-area">
        <label>
            用户名：
            <input type="text" class="form-control" name="username" id="sign-name" />
        </label>
        <label>
            密码：
            <input type="password" class="form-control" name="pwd" id="sign-pwd" />
        </label>
        <label>
            确认密码：
            <input type="password" class="form-control" name="pwd" id="sign-repwd" />
        </label>
        </br>
        <input type="button" value="注册" class="btn btn-primary" id="sign" />
    </div>

    <div id="banner">
        <transition-group tag="ul" class="images-area" :name="direction">
            <li v-for="(list,index) in imagelist" :key="index" v-show="index===currentIndex" @mouseenter="clearTimer"
                @mouseleave="startTimer">
                <a :href="list.clickUrl">
                    <img :src="list.image" :alt="list.desc">
                </a>
            </li>
        </transition-group>
        <div class="select-dot">
            <ul>
                <li v-for="(items,index) in imagelist" :key="index" @click='gotoimage(index), clearTimer()'
                    :class="['dot',{'Selected':currentIndex == index}]"></li>
            </ul>
        </div>
        <div class="sidebar sidebar-left" @click='gotoimage(preIndex), clearTimer()'>&lt;</div>
        <div class="sidebar sidebar-right" @click='gotoimage(nextIndex), clearTimer()'>&gt;</div>
    </div>

    <div class="select-module">
        <button>学习天地</button>
        <button>科普中心</button>
    </div>

    <div class="learn-area">
        <div class="title">
            <img src="assets/images/zoom-logo.png" alt="放大镜">
            学习天地 ———
        </div>

        <div class="learn-items">
            <div>
                <img src="assets/images/bg-video.png" /><p>学习视频</p>
            </div>
            <div>
                <img src="assets/images/bg-book.png" /><p>学习教材</p>
            </div>
            <div>
                <img src="assets/images/bg-ppt.png" /><p>学习PPT</p>
            </div>
            <div>
                <img src="assets/images/bg-3d.png" /><p>3D实验室</p>
            </div>
        </div>
    </div>

    <div class="science-area">
        <div class="title">
            <img src="assets/images/zoom-logo.png" alt="放大镜">
            科普中心 ———
        </div>

        <div class="science-items">
            <div>
                <img src="assets/images/bg-geography.png" />
            </div>
            <div>
                <img src="assets/images/bg-animal.png" />
            </div>
            <div>
                <img src="assets/images/bg-body.png" />
            </div>
        </div>
    </div>
</body>

<script>
    $('#show-login').click(() => {
        $('#login-area').show()
        $('#sign-area').hide()
    })

    $('#login').click(() => {
        if ($(" #login-name").val() != '' && $(" #login-pwd ").val() != '') {
            $.ajax({
                type: 'POST',
                contentType: "application/json;charset=UTF-8",
                url: '/api/webusers/loginin',
                data: JSON.stringify({
                    username: $(" #login-name").val(),
                    password: $(" #login-pwd ").val()
                }),
                success: function (result) {
                    if (result.status == 200) {
                        alert('登录成功！')
                    }
                    else {
                        alert('用户名或密码错误')
                    }
                },
                error: function (err) {
                    alert('服务器未响应')
                }
            })
        }
    })

    $("#sign-name").on('blur', () => {
        if ($("#sign_name").val() != '') {
            $.ajax({
                type: 'POST',
                contentType: "application/json;charset=UTF-8",
                url: '/api/webusers/checkSignName',
                data: JSON.stringify({ username: $("#sign-name").val() }),
                success: function (result) {
                    if (result.status == 200) {
                        alert('用户名可用！')
                    }
                    else {
                        alert('用户名重复')
                    }
                },
                error: function (err) {
                    alert('服务器未响应')
                }
            })
        }
    })

    $('#sign').click(() => {
        if ($("#sign_name").val() != '' && $("#sign_pwd").val() != '' && $("#sign_repwd").val() != '') {
            if ($("#sign_pwd").val() != $("#sign_repwd").val()) {
                alert("“两次密码输入不一致")
            } else {
                $.ajax({
                    type: 'POST',
                    contentType: "application/json;charset=UTF-8",
                    url: '/api/webusers/sign',
                    data: JSON.stringify({
                        username: $("#sign-name").val(),
                        password: $("#sign-pwd").val(),
                        repassword: $("#sign-repwd").val()
                    }),
                    success: function (result) {
                        if (result.status == 200) {
                            alert("注册成功!")
                        }
                        else {
                            alert("注册失败")
                        }
                    },
                    error: function (err) {
                        alert("服务器未响应");
                    }
                })
            }
        }
    })
</script>

<script>
    var banner = new Vue({
        el: '#banner',
        data: {
            imagelist: [
                { clickUrl: '#', desc: 'marqueen1', image: 'assets/images/marqueen1.png', },
                { clickUrl: '#', desc: 'earth', image: 'assets/images/earth.jpeg', },
                { clickUrl: '#', desc: 'mars', image: 'assets/images/mars.jpeg', }
            ],
            currentIndex: 0,
            timer: null,
            direction: 'left'
        },
        methods: {
            autoswitch() {
                this.timer = setInterval(() => {
                    this.direction = 'left'
                    this.gotoimage(this.nextIndex)
                }, 2000)
            },
            gotoimage(index) {
                if (index > this.currentIndex) {
                    this.direction = 'left'
                } else {
                    this.direction = 'right'
                }
                if (this.currentIndex == 0 && index == this.imagelist.length - 1) {
                    this.direction = 'right'
                }
                if (this.currentIndex == this.imagelist.length - 1 && index == 0) {
                    this.direction = 'left'
                }
                this.currentIndex = index
            },
            clearTimer() {
                clearInterval(this.timer)
                console.log('计时结束')
            },
            startTimer() {
                this.autoswitch()
                console.log('计时开始')
            }
        },
        computed: {
            preIndex() {
                this.direction = 'right'
                if (this.currentIndex == 0) {
                    return this.imagelist.length - 1
                } else {
                    return this.currentIndex - 1
                }
            },
            nextIndex() {
                this.direction = 'left'
                if (this.currentIndex == this.imagelist.length - 1) {
                    return 0
                } else {
                    return this.currentIndex + 1
                }
            }
        },
        mounted: function () {
            this.autoswitch()
        }
    })
</script>

</html>